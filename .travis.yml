language: objective-c

xcode_project: SymondsStudentApp.xcodeproj
xcode_scheme: SymondsStudentApp

branches:
  only:
    - master

notifications:
  email: false

before_install:
  - SIMULATOR_ID=$(xcrun instruments -s | grep -o "iPhone 7 (10.0) \[.*\]" | grep -o "\[.*\]" | sed "s/^\[\(.*\)\]$/\1/")
  - echo "Prelaunching iOS simulator with UDID $SIMULATOR_ID"
  - open -a "simulator" --args -CurrentDeviceUDID $SIMULATOR_ID
  - gem update bundler

install:
  - bundle install

script:
  - xcodebuild clean build test -project SymondsStudentApp.xcodeproj -scheme SymondsStudentApp | xcpretty && exit ${PIPESTATUS[0]}
